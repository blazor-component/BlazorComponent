{"version":3,"file":"activatable.js","sources":["../../../BlazorComponent.Web/src/mixins/activatable/index.ts"],"sourcesContent":["type Listeners = Record<\n  string,\n  (e: MouseEvent & KeyboardEvent & FocusEvent) => void\n>;\n\nclass Activatable {\n  activator: HTMLElement;\n  disabled: boolean;\n  openOnClick: boolean;\n  openOnHover: boolean;\n  openOnFocus: boolean;\n  dotNetHelper: DotNet.DotNetObject;\n\n  isActive: boolean;\n  listeners: Listeners;\n\n  constructor(\n    selector: string,\n    disabled: boolean,\n    openOnClick: boolean,\n    openOnHover: boolean,\n    openOnFocus: boolean,\n    dotNetHelper: DotNet.DotNetObject\n  ) {\n    this.activator = document.querySelector(selector);\n    this.disabled = disabled;\n    this.openOnClick = openOnClick;\n    this.openOnHover = openOnHover;\n    this.openOnFocus = openOnFocus;\n    this.dotNetHelper = dotNetHelper;\n  }\n\n  addActivatorEvents() {\n    if (!this.activator || this.disabled) return;\n\n    this.listeners = this.genActivatorListeners();\n    const keys = Object.keys(this.listeners);\n\n    for (const key of keys) {\n      this.activator.addEventListener(key, this.listeners[key]);\n    }\n  }\n\n  genActivatorListeners() {\n    if (this.disabled) return {};\n\n    const listeners: Listeners = {};\n\n    if (this.openOnHover) {\n      listeners.mouseenter = (e: MouseEvent) => {\n        console.log(\"mouseenter\");\n        this.runDelay(\"open\");\n      };\n      listeners.mouseleave = (e: MouseEvent) => {\n        console.log(\"mouseleave\");\n        this.runDelay(\"close\");\n      };\n    } else if (this.openOnClick) {\n      listeners.click = (e: MouseEvent) => {\n        if (this.activator) this.activator.focus();\n\n        e.stopPropagation();\n\n        this.setActive(!this.isActive);\n      };\n    }\n\n    if (this.openOnFocus) {\n      listeners.focus = (e: FocusEvent) => {\n        e.stopPropagation();\n\n        this.setActive(!this.isActive);\n      };\n    }\n\n    return listeners;\n  }\n\n  removeActivatorEvents() {\n    if (!this.activator) return;\n\n    const keys = Object.keys(this.listeners);\n\n    for (const key of keys) {\n      (this.activator as any).removeEventListener(key, this.listeners[key]);\n    }\n\n    this.listeners = {};\n  }\n\n  resetActivator() {\n    this.removeActivatorEvents();\n    this.addActivatorEvents();\n  }\n\n  runDelay(type: \"open\" | \"close\") {\n    this.setActive({ open: true, close: false }[type]);\n  }\n\n  setActive(active: boolean) {\n    this.isActive = active;\n    this.dotNetHelper.invokeMethodAsync(\"SetActive\", this.isActive);\n  }\n}\n\nconst instances: Record<string, Activatable> = {};\n\nfunction init(\n  selector: string,\n  disabled: boolean,\n  openOnClick: boolean,\n  openOnHover: boolean,\n  openOnFocus: boolean,\n  dotNetHelper: DotNet.DotNetObject\n) {\n  const key = dotNetHelper[\"_id\"];\n  console.log(\"key\", key, dotNetHelper);\n\n  var instance = new Activatable(\n    selector,\n    disabled,\n    openOnClick,\n    openOnHover,\n    openOnFocus,\n    dotNetHelper\n  );\n\n  instances[key] = instance;\n\n  instance.addActivatorEvents();\n}\n\nfunction reset(dotNetHelper: DotNet.DotNetObject) {\n  const key = dotNetHelper[\"_id\"];\n  const instance = instances[key];\n  instance.resetActivator();\n}\n\nexport { init, reset };\n"],"names":["Activatable","constructor","selector","disabled","openOnClick","openOnHover","openOnFocus","dotNetHelper","this","activator","document","querySelector","addActivatorEvents","listeners","genActivatorListeners","keys","Object","key","addEventListener","mouseenter","e","console","log","runDelay","mouseleave","click","focus","stopPropagation","setActive","isActive","removeActivatorEvents","removeEventListener","resetActivator","type","open","close","active","invokeMethodAsync","instances","init","instance","reset"],"mappings":"AAKA,MAAMA,EAWJC,YACEC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEAC,KAAKC,UAAYC,SAASC,cAAcT,GACxCM,KAAKL,SAAWA,EAChBK,KAAKJ,YAAcA,EACnBI,KAAKH,YAAcA,EACnBG,KAAKF,YAAcA,EACnBE,KAAKD,aAAeA,CACrB,CAEDK,qBACE,IAAKJ,KAAKC,WAAaD,KAAKL,SAAU,OAEtCK,KAAKK,UAAYL,KAAKM,wBACtB,MAAMC,EAAOC,OAAOD,KAAKP,KAAKK,WAE9B,IAAK,MAAMI,KAAOF,EAChBP,KAAKC,UAAUS,iBAAiBD,EAAKT,KAAKK,UAAUI,GAEvD,CAEDH,wBACE,GAAIN,KAAKL,SAAU,MAAO,GAE1B,MAAMU,EAAuB,CAAA,EA6B7B,OA3BIL,KAAKH,aACPQ,EAAUM,WAAcC,IACtBC,QAAQC,IAAI,cACZd,KAAKe,SAAS,OAAO,EAEvBV,EAAUW,WAAcJ,IACtBC,QAAQC,IAAI,cACZd,KAAKe,SAAS,QAAQ,GAEff,KAAKJ,cACdS,EAAUY,MAASL,IACbZ,KAAKC,WAAWD,KAAKC,UAAUiB,QAEnCN,EAAEO,kBAEFnB,KAAKoB,WAAWpB,KAAKqB,SAAS,GAI9BrB,KAAKF,cACPO,EAAUa,MAASN,IACjBA,EAAEO,kBAEFnB,KAAKoB,WAAWpB,KAAKqB,SAAS,GAI3BhB,CACR,CAEDiB,wBACE,IAAKtB,KAAKC,UAAW,OAErB,MAAMM,EAAOC,OAAOD,KAAKP,KAAKK,WAE9B,IAAK,MAAMI,KAAOF,EACfP,KAAKC,UAAkBsB,oBAAoBd,EAAKT,KAAKK,UAAUI,IAGlET,KAAKK,UAAY,EAClB,CAEDmB,iBACExB,KAAKsB,wBACLtB,KAAKI,oBACN,CAEDW,SAASU,GACPzB,KAAKoB,UAAU,CAAEM,MAAM,EAAMC,OAAO,GAAQF,GAC7C,CAEDL,UAAUQ,GACR5B,KAAKqB,SAAWO,EAChB5B,KAAKD,aAAa8B,kBAAkB,YAAa7B,KAAKqB,SACvD,EAGH,MAAMS,EAAyC,CAAA,EAE/C,SAASC,EACPrC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,MAAMU,EAAMV,EAAkB,IAC9Bc,QAAQC,IAAI,MAAOL,EAAKV,GAExB,IAAIiC,EAAW,IAAIxC,EACjBE,EACAC,EACAC,EACAC,EACAC,EACAC,GAGF+B,EAAUrB,GAAOuB,EAEjBA,EAAS5B,oBACX,CAEA,SAAS6B,EAAMlC,GACb,MAAMU,EAAMV,EAAkB,IACb+B,EAAUrB,GAClBe,gBACX"}