class e extends class{constructor(e,t,s){this.openDelay=e,this.closeDelay=t,this.dotNetHelper=s}clearDelay(){clearTimeout(this.openTimeout),clearTimeout(this.closeTimeout)}runDelay(e,t){this.clearDelay();const s=parseInt(this[`${e}Delay`],10);this[`${e}Timeout`]=setTimeout(t||(()=>{const t={open:!0,close:!1}[e];this.setActive(t)}),s)}setActive(e){console.log("setActive: ",e,"is return:",this.isActive==e),this.isActive!=e&&(this.isActive=e,this.dotNetHelper.invokeMethodAsync("SetActive",this.isActive))}}{constructor(e,t,s,o,i,n,c,r){super(n,c,r),console.log("activatorSelector",e);const l=document.querySelector(e);console.log("activator",l),l&&(this.activator=l),this.disabled=t,this.openOnClick=s,this.openOnHover=o,this.openOnFocus=i,this.dotNetHelper=r}resetActivator(e){console.log("resetActivator selector",e);const t=document.querySelector(e);t&&(this.activator=t),console.log("resetActivator got the activator",this.activator),this.resetActivatorEvents(this.disabled,this.openOnHover,this.openOnFocus)}addActivatorEvents(){if(!this.activator||this.disabled)return;this.popupListeners=this.genActivatorListeners();const e=Object.keys(this.popupListeners);for(const t of e)this.activator.addEventListener(t,this.popupListeners[t])}genActivatorListeners(){if(this.disabled)return{};const e={};return this.openOnHover?(e.mouseenter=e=>{console.log("mouseenter",this.isActive),this.runDelay("open")},e.mouseleave=e=>{console.log("mouseleave",this.isActive),this.runDelay("close")}):this.openOnClick&&(e.click=e=>{var t;console.log(this.activator.id),this.activator&&this.activator.focus(),e.stopPropagation(),this.dotNetHelper.invokeMethodAsync("OnClick",{detail:(t=e).detail,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY,button:t.button,buttons:t.buttons,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey,metaKey:t.metaKey,type:t.type}),this.setActive(!this.isActive)}),this.openOnFocus&&(e.focus=e=>{e.stopPropagation(),this.runDelay("open")},e.blur=e=>{this.runDelay("close")}),e}removeActivatorEvents(){if(!this.activator)return;const e=Object.keys(this.popupListeners);for(const t of e)this.activator.removeEventListener(t,this.popupListeners[t]);this.popupListeners={}}resetActivatorEvents(e,t,s){this.disabled=e,this.openOnHover=t,this.openOnFocus=s,this.removeActivatorEvents(),this.addActivatorEvents()}runDelaying(e){console.log("runDelaying",e),this.runDelay(e?"open":"close")}registerPopup(e,t,s,o){console.log("registerPop",e),console.log("closeOnOutsideClick",t),console.log("closeOnContentClick",s);const i=document.querySelector(e);i?(this.popupElement=i,this.closeOnOutsideClick=t,this.closeOnContentClick=s,this.disableDefaultOutsideClickEvent=o,this.addPopupEvents(),this.addDocumentEvents()):console.error("popup not exists")}addPopupEvents(){if(!this.popupElement||this.disabled)return;this.popupListeners=this.genPopupListeners();const e=Object.keys(this.popupListeners);for(const t of e)this.popupElement.addEventListener(t,this.popupListeners[t])}addDocumentEvents(){if(this.disabled)return;this.documentListeners=this.genDocumentListeners();const e=Object.keys(this.documentListeners);for(const t of e)document.addEventListener(t,this.documentListeners[t],!0)}removePopupEvents(){if(!this.popupElement)return;const e=Object.keys(this.popupListeners);for(const t of e)this.popupElement.removeEventListener(t,this.popupListeners[t]);this.popupListeners={}}removeDocumentEvents(){const e=Object.keys(this.documentListeners);for(const t of e)document.removeEventListener(t,this.documentListeners[t]);this.documentListeners={}}genPopupListeners(){if(this.disabled)return;const e={};return!this.disabled&&this.openOnHover&&(e.mouseenter=e=>{console.log("content mouseenter"),this.runDelay("open")},e.mouseleave=e=>{console.log("content mouseleave"),this.runDelay("close")}),this.closeOnContentClick&&(e.click=e=>{console.log("content click",e),this.setActive(!1)}),e}genDocumentListeners(){const e={};return!this.openOnHover&&this.closeOnOutsideClick&&(e.click=e=>{this.popupElement.contains(e.target)||this.activator&&this.activator.contains(e.target)||(this.dotNetHelper.invokeMethodAsync("OnOutsideClick"),this.disableDefaultOutsideClickEvent||(console.log("outside click: set active to false"),this.setActive(!1)))}),e}resetPopupAndDocumentEvents(e,t){this.closeOnOutsideClick=e,this.closeOnContentClick=t,this.removePopupEvents(),this.removeDocumentEvents(),this.addPopupEvents(),this.addDocumentEvents()}}function t(t,s,o,i,n,c,r,l){var a=new e(t,s,o,i,n,c,r,l);return a.addActivatorEvents(),a}export{t as init};
//# sourceMappingURL=activatable.js.map
